<div class="crud-card">
  <div class="crud-table__toolbar">
    <div class="crud-table__left">
      @if (showSearch()) {
        <mat-form-field appearance="outline" class="crud-table__search">
          <mat-label>Rechercher</mat-label>
          <input matInput type="search" #q (input)="onSearch(q.value)" aria-label="Rechercher" />
        </mat-form-field>
      }
    </div>
    <div class="crud-table__center">
      <div class="crud-table__title">{{ title() }}</div>
    </div>
    <div class="crud-table__right">
      <button mat-icon-button color="primary" aria-label="Ajouter un élément" (click)="addItem.emit()">
        <mat-icon fontIcon="add"></mat-icon>
      </button>
    </div>
  </div>

  <table mat-table [dataSource]="dataSource()" class="mat-elevation-z2 demo-table">

    @for (column of displayedColumns(); track column) {
      <ng-container [matColumnDef]="column">
        <th mat-header-cell *matHeaderCellDef>{{ column }}</th>
        <td mat-cell *matCellDef="let element">{{ element[column] }}</td>
      </ng-container>
    }

    <tr mat-header-row *matHeaderRowDef="displayedColumns()"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns();"></tr>

    <!-- État vide: ligne couvrant toutes les colonnes -->
    <tr class="mat-mdc-row" *matNoDataRow>
      <td class="mat-mdc-cell crud-table__empty" [attr.colspan]="displayedColumns().length">
        {{ emptyMessage() }}
      </td>
    </tr>

  </table>
</div>
